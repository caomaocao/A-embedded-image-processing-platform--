#include "sys.h"
#include "usart.h"		
#include "delay.h"	
#include "led.h" 
#include "beep.h"	 	 
#include "key.h"	 	 
#include "exti.h"	 	 
#include "wdg.h" 	 
#include "timer.h"		 	 
#include "tpad.h"
#include "oled.h"		 	 
#include "lcd.h"
#include "usmart.h"	
#include "rtc.h"	 	 
#include "wkup.h"	
#include "adc.h" 	 
#include "dac.h" 	 
#include "dma.h" 	 
#include "24cxx.h" 	 
#include "flash.h" 	 
#include "rs485.h" 	 
#include "can.h" 	 
#include "touch.h" 	 
#include "remote.h" 	 
#include "joypad.h"
#include "adxl345.h"
#include "ds18b20.h"
#include "dht11.h"
#include "24l01.h"
#include "mouse.h"
#include "stmflash.h"
#include "rda5820.h"
#include "audiosel.h"
#include "ov7670.h"
#include "malloc.h"
#include "sram.h"
#include "cass/configuration_control.h"
#include "cass/configuration_system.h"
#include "cass/configuration_address.h"

#define NUMBER_POINT_SUM 30

const u8*LMODE_TBL[5]={"Auto","Sunny","Cloudy","Office","Home"};							//5种光照模式	    
const u8*EFFECTS_TBL[7]={"Normal","Negative","B&W","Redish","Greenish","Bluish","Antique"};	//7种特效 
u8 lightmode=0,saturation=0,brightness=0,contrast=0,effect=0;

extern u8 ov_sta;	//在exit.c里面定义
extern u8 ov_frame;	//在timer.c里面定义		 

u8 CassMem[4096];
extern u8 raw_data[];
extern u8 out_data[];
extern u8 temp_data[];
extern u8 ComInDataOk;

extern u16 cass_mv_boarder_width;
extern u16 cass_mv_boarder_height;
extern u16 cass_mv_boarder_leftbound,cass_mv_boarder_topbound;
int small_leftbound=0,small_rightbound=0,small_topbound=0,small_downbound=0;//待检测区域内的框住数字最小框

image_data_packet_desc_type  image_data_packet_desc={0,0,0,0,0,0,0,0,0,0,142,46,192,79, 142,46,50,33,6,5,0,100,14,8,255,1,14,8,255,1,22,8,255,1,34,8,255,1,38,8,255,1,11,10,255,1,43,10,255,1,9,14,255,1,44,14,255,1,9,18,255,1,44,18,255,1,11,22,255,1,14,24,255,1,26,23,255,1,30,23,255,1,43,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,13,0,100,8,16,255,1,10,16,255,1,18,16,255,1,26,16,255,1,34,16,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,100,12,8,255,1,14,8,255,1,22,9,255,1,43,7,255,1,11,9,255,1,22,9,255,1,22,9,255,1,43,9,255,1,9,13,255,1,28,13,255,1,30,14,255,1,43,13,255,1,9,17,255,1,33,17,255,1,43,17,255,1,10,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,3,0,100,28,4,255,1,29,4,255,1,37,7,255,1,10,11,255,1,13,12,255,1,26,8,255,1,40,8,255,1,9,12,255,1,13,12,255,1,21,12,255,1,43,12,255,1,9,16,255,1,43,16,255,1,9,20,255,1,43,20,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,100,11,12,255,1,12,12,255,1,25,11,255,1,28,11,255,1,36,11,255,1,15,13,255,1,20,13,255,1,35,13,255,1,23,17,255,1,35,17,255,1,27,21,255,1,28,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,26,9,255,1,34,8,255,1,38,8,255,1,9,12,255,1,25,10,255,1,43,10,255,1,9,14,255,1,24,14,255,1,43,14,255,1,9,18,255,1,24,18,255,1,44,18,255,1,9,22,255,1,14,23,255,1,24,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,5,0,100,26,9,255,1,34,8,255,1,36,8,255,1,7,14,255,1,25,10,255,1,41,10,255,1,7,14,255,1,12,17,255,1,24,14,255,1,41,14,255,1,13,18,255,1,24,18,255,1,41,18,255,1,24,22,255,1,28,23,255,1,41,22,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,100,9,11,255,1,13,11,255,1,21,13,255,1,8,14,255,1,24,14,255,1,29,15,255,1,37,17,255,1,8,18,255,1,38,18,255,1,17,15,255,1,9,23,255,1,17,15,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,9,255,1,12,9,255,1,20,10,255,1,33,9,255,1,36,9,255,1,8,11,255,1,21,11,255,1,28,11,255,1,41,11,255,1,7,15,255,1,25,15,255,1,42,15,255,1,7,19,255,1,25,19,255,1,28,23,255,1,42,19,255,1,7,23,255,1,17,24,255,1,21,23,255,1,28,23,255,1,41,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,10,255,1,13,10,255,1,21,10,255,1,9,11,255,1,26,11,255,1,29,13,255,1,37,15,255,1,8,15,255,1,27,15,255,1,36,15,255,1,37,15,255,1,8,19,255,1,26,19,255,1,42,19,255,1,9,23,255,1,13,25,255,1,26,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,14,8,255,1,14,8,255,1,22,8,255,1,34,8,255,1,38,8,255,1,11,10,255,1,43,10,255,1,9,14,255,1,44,14,255,1,9,18,255,1,44,18,255,1,11,22,255,1,14,24,255,1,26,23,255,1,30,23,255,1,43,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,13,0,100,8,16,255,1,10,16,255,1,18,16,255,1,26,16,255,1,34,16,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,100,12,8,255,1,14,8,255,1,22,9,255,1,43,7,255,1,11,9,255,1,22,9,255,1,22,9,255,1,43,9,255,1,9,13,255,1,28,13,255,1,30,14,255,1,43,13,255,1,9,17,255,1,33,17,255,1,43,17,255,1,10,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,3,0,100,28,4,255,1,29,4,255,1,37,7,255,1,10,11,255,1,13,12,255,1,26,8,255,1,40,8,255,1,9,12,255,1,13,12,255,1,21,12,255,1,43,12,255,1,9,16,255,1,43,16,255,1,9,20,255,1,43,20,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,100,11,12,255,1,12,12,255,1,25,11,255,1,28,11,255,1,36,11,255,1,15,13,255,1,20,13,255,1,35,13,255,1,23,17,255,1,35,17,255,1,27,21,255,1,28,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,26,9,255,1,34,8,255,1,38,8,255,1,9,12,255,1,25,10,255,1,43,10,255,1,9,14,255,1,24,14,255,1,43,14,255,1,9,18,255,1,24,18,255,1,44,18,255,1,9,22,255,1,14,23,255,1,24,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,5,0,100,26,9,255,1,34,8,255,1,36,8,255,1,7,14,255,1,25,10,255,1,41,10,255,1,7,14,255,1,12,17,255,1,24,14,255,1,41,14,255,1,13,18,255,1,24,18,255,1,41,18,255,1,24,22,255,1,28,23,255,1,41,22,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,100,9,11,255,1,13,11,255,1,21,13,255,1,8,14,255,1,24,14,255,1,29,15,255,1,37,17,255,1,8,18,255,1,38,18,255,1,17,15,255,1,9,23,255,1,17,15,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,9,255,1,12,9,255,1,20,10,255,1,33,9,255,1,36,9,255,1,8,11,255,1,21,11,255,1,28,11,255,1,41,11,255,1,7,15,255,1,25,15,255,1,42,15,255,1,7,19,255,1,25,19,255,1,28,23,255,1,42,19,255,1,7,23,255,1,17,24,255,1,21,23,255,1,28,23,255,1,41,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,10,255,1,13,10,255,1,21,10,255,1,9,11,255,1,26,11,255,1,29,13,255,1,37,15,255,1,8,15,255,1,27,15,255,1,36,15,255,1,37,15,255,1,8,19,255,1,26,19,255,1,42,19,255,1,9,23,255,1,13,25,255,1,26,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,14,8,255,1,14,8,255,1,22,8,255,1,34,8,255,1,38,8,255,1,11,10,255,1,43,10,255,1,9,14,255,1,44,14,255,1,9,18,255,1,44,18,255,1,11,22,255,1,14,24,255,1,26,23,255,1,30,23,255,1,43,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,13,0,100,8,16,255,1,10,16,255,1,18,16,255,1,26,16,255,1,34,16,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,100,12,8,255,1,14,8,255,1,22,9,255,1,43,7,255,1,11,9,255,1,22,9,255,1,22,9,255,1,43,9,255,1,9,13,255,1,28,13,255,1,30,14,255,1,43,13,255,1,9,17,255,1,33,17,255,1,43,17,255,1,10,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,3,0,100,28,4,255,1,29,4,255,1,37,7,255,1,10,11,255,1,13,12,255,1,26,8,255,1,40,8,255,1,9,12,255,1,13,12,255,1,21,12,255,1,43,12,255,1,9,16,255,1,43,16,255,1,9,20,255,1,43,20,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,100,11,12,255,1,12,12,255,1,25,11,255,1,28,11,255,1,36,11,255,1,15,13,255,1,20,13,255,1,35,13,255,1,23,17,255,1,35,17,255,1,27,21,255,1,28,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,26,9,255,1,34,8,255,1,38,8,255,1,9,12,255,1,25,10,255,1,43,10,255,1,9,14,255,1,24,14,255,1,43,14,255,1,9,18,255,1,24,18,255,1,44,18,255,1,9,22,255,1,14,23,255,1,24,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,5,0,100,26,9,255,1,34,8,255,1,36,8,255,1,7,14,255,1,25,10,255,1,41,10,255,1,7,14,255,1,12,17,255,1,24,14,255,1,41,14,255,1,13,18,255,1,24,18,255,1,41,18,255,1,24,22,255,1,28,23,255,1,41,22,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,100,9,11,255,1,13,11,255,1,21,13,255,1,8,14,255,1,24,14,255,1,29,15,255,1,37,17,255,1,8,18,255,1,38,18,255,1,17,15,255,1,9,23,255,1,17,15,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,9,255,1,12,9,255,1,20,10,255,1,33,9,255,1,36,9,255,1,8,11,255,1,21,11,255,1,28,11,255,1,41,11,255,1,7,15,255,1,25,15,255,1,42,15,255,1,7,19,255,1,25,19,255,1,28,23,255,1,42,19,255,1,7,23,255,1,17,24,255,1,21,23,255,1,28,23,255,1,41,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,10,255,1,13,10,255,1,21,10,255,1,9,11,255,1,26,11,255,1,29,13,255,1,37,15,255,1,8,15,255,1,27,15,255,1,36,15,255,1,37,15,255,1,8,19,255,1,26,19,255,1,42,19,255,1,9,23,255,1,13,25,255,1,26,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,14,8,255,1,14,8,255,1,22,8,255,1,34,8,255,1,38,8,255,1,11,10,255,1,43,10,255,1,9,14,255,1,44,14,255,1,9,18,255,1,44,18,255,1,11,22,255,1,14,24,255,1,26,23,255,1,30,23,255,1,43,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,13,0,100,8,16,255,1,10,16,255,1,18,16,255,1,26,16,255,1,34,16,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,100,12,8,255,1,14,8,255,1,22,9,255,1,43,7,255,1,11,9,255,1,22,9,255,1,22,9,255,1,43,9,255,1,9,13,255,1,28,13,255,1,30,14,255,1,43,13,255,1,9,17,255,1,33,17,255,1,43,17,255,1,10,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,3,0,100,28,4,255,1,29,4,255,1,37,7,255,1,10,11,255,1,13,12,255,1,26,8,255,1,40,8,255,1,9,12,255,1,13,12,255,1,21,12,255,1,43,12,255,1,9,16,255,1,43,16,255,1,9,20,255,1,43,20,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,100,11,12,255,1,12,12,255,1,25,11,255,1,28,11,255,1,36,11,255,1,15,13,255,1,20,13,255,1,35,13,255,1,23,17,255,1,35,17,255,1,27,21,255,1,28,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,26,9,255,1,34,8,255,1,38,8,255,1,9,12,255,1,25,10,255,1,43,10,255,1,9,14,255,1,24,14,255,1,43,14,255,1,9,18,255,1,24,18,255,1,44,18,255,1,9,22,255,1,14,23,255,1,24,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,5,0,100,26,9,255,1,34,8,255,1,36,8,255,1,7,14,255,1,25,10,255,1,41,10,255,1,7,14,255,1,12,17,255,1,24,14,255,1,41,14,255,1,13,18,255,1,24,18,255,1,41,18,255,1,24,22,255,1,28,23,255,1,41,22,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,100,9,11,255,1,13,11,255,1,21,13,255,1,8,14,255,1,24,14,255,1,29,15,255,1,37,17,255,1,8,18,255,1,38,18,255,1,17,15,255,1,9,23,255,1,17,15,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,9,255,1,12,9,255,1,20,10,255,1,33,9,255,1,36,9,255,1,8,11,255,1,21,11,255,1,28,11,255,1,41,11,255,1,7,15,255,1,25,15,255,1,42,15,255,1,7,19,255,1,25,19,255,1,28,23,255,1,42,19,255,1,7,23,255,1,17,24,255,1,21,23,255,1,28,23,255,1,41,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,10,255,1,13,10,255,1,21,10,255,1,9,11,255,1,26,11,255,1,29,13,255,1,37,15,255,1,8,15,255,1,27,15,255,1,36,15,255,1,37,15,255,1,8,19,255,1,26,19,255,1,42,19,255,1,9,23,255,1,13,25,255,1,26,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,14,8,255,1,14,8,255,1,22,8,255,1,34,8,255,1,38,8,255,1,11,10,255,1,43,10,255,1,9,14,255,1,44,14,255,1,9,18,255,1,44,18,255,1,11,22,255,1,14,24,255,1,26,23,255,1,30,23,255,1,43,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,13,0,100,8,16,255,1,10,16,255,1,18,16,255,1,26,16,255,1,34,16,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,100,12,8,255,1,14,8,255,1,22,9,255,1,43,7,255,1,11,9,255,1,22,9,255,1,22,9,255,1,43,9,255,1,9,13,255,1,28,13,255,1,30,14,255,1,43,13,255,1,9,17,255,1,33,17,255,1,43,17,255,1,10,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,3,0,100,28,4,255,1,29,4,255,1,37,7,255,1,10,11,255,1,13,12,255,1,26,8,255,1,40,8,255,1,9,12,255,1,13,12,255,1,21,12,255,1,43,12,255,1,9,16,255,1,43,16,255,1,9,20,255,1,43,20,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,100,11,12,255,1,12,12,255,1,25,11,255,1,28,11,255,1,36,11,255,1,15,13,255,1,20,13,255,1,35,13,255,1,23,17,255,1,35,17,255,1,27,21,255,1,28,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,26,9,255,1,34,8,255,1,38,8,255,1,9,12,255,1,25,10,255,1,43,10,255,1,9,14,255,1,24,14,255,1,43,14,255,1,9,18,255,1,24,18,255,1,44,18,255,1,9,22,255,1,14,23,255,1,24,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,5,0,100,26,9,255,1,34,8,255,1,36,8,255,1,7,14,255,1,25,10,255,1,41,10,255,1,7,14,255,1,12,17,255,1,24,14,255,1,41,14,255,1,13,18,255,1,24,18,255,1,41,18,255,1,24,22,255,1,28,23,255,1,41,22,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,100,9,11,255,1,13,11,255,1,21,13,255,1,8,14,255,1,24,14,255,1,29,15,255,1,37,17,255,1,8,18,255,1,38,18,255,1,17,15,255,1,9,23,255,1,17,15,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,9,255,1,12,9,255,1,20,10,255,1,33,9,255,1,36,9,255,1,8,11,255,1,21,11,255,1,28,11,255,1,41,11,255,1,7,15,255,1,25,15,255,1,42,15,255,1,7,19,255,1,25,19,255,1,28,23,255,1,42,19,255,1,7,23,255,1,17,24,255,1,21,23,255,1,28,23,255,1,41,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,10,255,1,13,10,255,1,21,10,255,1,9,11,255,1,26,11,255,1,29,13,255,1,37,15,255,1,8,15,255,1,27,15,255,1,36,15,255,1,37,15,255,1,8,19,255,1,26,19,255,1,42,19,255,1,9,23,255,1,13,25,255,1,26,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,14,8,255,1,14,8,255,1,22,8,255,1,34,8,255,1,38,8,255,1,11,10,255,1,43,10,255,1,9,14,255,1,44,14,255,1,9,18,255,1,44,18,255,1,11,22,255,1,14,24,255,1,26,23,255,1,30,23,255,1,43,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,13,0,100,8,16,255,1,10,16,255,1,18,16,255,1,26,16,255,1,34,16,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,100,12,8,255,1,14,8,255,1,22,9,255,1,43,7,255,1,11,9,255,1,22,9,255,1,22,9,255,1,43,9,255,1,9,13,255,1,28,13,255,1,30,14,255,1,43,13,255,1,9,17,255,1,33,17,255,1,43,17,255,1,10,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,3,0,100,28,4,255,1,29,4,255,1,37,7,255,1,10,11,255,1,13,12,255,1,26,8,255,1,40,8,255,1,9,12,255,1,13,12,255,1,21,12,255,1,43,12,255,1,9,16,255,1,43,16,255,1,9,20,255,1,43,20,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,100,11,12,255,1,12,12,255,1,25,11,255,1,28,11,255,1,36,11,255,1,15,13,255,1,20,13,255,1,35,13,255,1,23,17,255,1,35,17,255,1,27,21,255,1,28,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,26,9,255,1,34,8,255,1,38,8,255,1,9,12,255,1,25,10,255,1,43,10,255,1,9,14,255,1,24,14,255,1,43,14,255,1,9,18,255,1,24,18,255,1,44,18,255,1,9,22,255,1,14,23,255,1,24,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,5,0,100,26,9,255,1,34,8,255,1,36,8,255,1,7,14,255,1,25,10,255,1,41,10,255,1,7,14,255,1,12,17,255,1,24,14,255,1,41,14,255,1,13,18,255,1,24,18,255,1,41,18,255,1,24,22,255,1,28,23,255,1,41,22,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,100,9,11,255,1,13,11,255,1,21,13,255,1,8,14,255,1,24,14,255,1,29,15,255,1,37,17,255,1,8,18,255,1,38,18,255,1,17,15,255,1,9,23,255,1,17,15,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,9,255,1,12,9,255,1,20,10,255,1,33,9,255,1,36,9,255,1,8,11,255,1,21,11,255,1,28,11,255,1,41,11,255,1,7,15,255,1,25,15,255,1,42,15,255,1,7,19,255,1,25,19,255,1,28,23,255,1,42,19,255,1,7,23,255,1,17,24,255,1,21,23,255,1,28,23,255,1,41,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,10,255,1,13,10,255,1,21,10,255,1,9,11,255,1,26,11,255,1,29,13,255,1,37,15,255,1,8,15,255,1,27,15,255,1,36,15,255,1,37,15,255,1,8,19,255,1,26,19,255,1,42,19,255,1,9,23,255,1,13,25,255,1,26,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,14,8,255,1,14,8,255,1,22,8,255,1,34,8,255,1,38,8,255,1,11,10,255,1,43,10,255,1,9,14,255,1,44,14,255,1,9,18,255,1,44,18,255,1,11,22,255,1,14,24,255,1,26,23,255,1,30,23,255,1,43,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,13,0,100,8,16,255,1,10,16,255,1,18,16,255,1,26,16,255,1,34,16,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,100,12,8,255,1,14,8,255,1,22,9,255,1,43,7,255,1,11,9,255,1,22,9,255,1,22,9,255,1,43,9,255,1,9,13,255,1,28,13,255,1,30,14,255,1,43,13,255,1,9,17,255,1,33,17,255,1,43,17,255,1,10,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,3,0,100,28,4,255,1,29,4,255,1,37,7,255,1,10,11,255,1,13,12,255,1,26,8,255,1,40,8,255,1,9,12,255,1,13,12,255,1,21,12,255,1,43,12,255,1,9,16,255,1,43,16,255,1,9,20,255,1,43,20,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,100,11,12,255,1,12,12,255,1,25,11,255,1,28,11,255,1,36,11,255,1,15,13,255,1,20,13,255,1,35,13,255,1,23,17,255,1,35,17,255,1,27,21,255,1,28,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,26,9,255,1,34,8,255,1,38,8,255,1,9,12,255,1,25,10,255,1,43,10,255,1,9,14,255,1,24,14,255,1,43,14,255,1,9,18,255,1,24,18,255,1,44,18,255,1,9,22,255,1,14,23,255,1,24,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,5,0,100,26,9,255,1,34,8,255,1,36,8,255,1,7,14,255,1,25,10,255,1,41,10,255,1,7,14,255,1,12,17,255,1,24,14,255,1,41,14,255,1,13,18,255,1,24,18,255,1,41,18,255,1,24,22,255,1,28,23,255,1,41,22,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,100,9,11,255,1,13,11,255,1,21,13,255,1,8,14,255,1,24,14,255,1,29,15,255,1,37,17,255,1,8,18,255,1,38,18,255,1,17,15,255,1,9,23,255,1,17,15,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,9,255,1,12,9,255,1,20,10,255,1,33,9,255,1,36,9,255,1,8,11,255,1,21,11,255,1,28,11,255,1,41,11,255,1,7,15,255,1,25,15,255,1,42,15,255,1,7,19,255,1,25,19,255,1,28,23,255,1,42,19,255,1,7,23,255,1,17,24,255,1,21,23,255,1,28,23,255,1,41,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,10,255,1,13,10,255,1,21,10,255,1,9,11,255,1,26,11,255,1,29,13,255,1,37,15,255,1,8,15,255,1,27,15,255,1,36,15,255,1,37,15,255,1,8,19,255,1,26,19,255,1,42,19,255,1,9,23,255,1,13,25,255,1,26,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,14,8,255,1,14,8,255,1,22,8,255,1,34,8,255,1,38,8,255,1,11,10,255,1,43,10,255,1,9,14,255,1,44,14,255,1,9,18,255,1,44,18,255,1,11,22,255,1,14,24,255,1,26,23,255,1,30,23,255,1,43,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,13,0,100,8,16,255,1,10,16,255,1,18,16,255,1,26,16,255,1,34,16,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,100,12,8,255,1,14,8,255,1,22,9,255,1,43,7,255,1,11,9,255,1,22,9,255,1,22,9,255,1,43,9,255,1,9,13,255,1,28,13,255,1,30,14,255,1,43,13,255,1,9,17,255,1,33,17,255,1,43,17,255,1,10,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,3,0,100,28,4,255,1,29,4,255,1,37,7,255,1,10,11,255,1,13,12,255,1,26,8,255,1,40,8,255,1,9,12,255,1,13,12,255,1,21,12,255,1,43,12,255,1,9,16,255,1,43,16,255,1,9,20,255,1,43,20,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,100,11,12,255,1,12,12,255,1,25,11,255,1,28,11,255,1,36,11,255,1,15,13,255,1,20,13,255,1,35,13,255,1,23,17,255,1,35,17,255,1,27,21,255,1,28,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,26,9,255,1,34,8,255,1,38,8,255,1,9,12,255,1,25,10,255,1,43,10,255,1,9,14,255,1,24,14,255,1,43,14,255,1,9,18,255,1,24,18,255,1,44,18,255,1,9,22,255,1,14,23,255,1,24,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,5,0,100,26,9,255,1,34,8,255,1,36,8,255,1,7,14,255,1,25,10,255,1,41,10,255,1,7,14,255,1,12,17,255,1,24,14,255,1,41,14,255,1,13,18,255,1,24,18,255,1,41,18,255,1,24,22,255,1,28,23,255,1,41,22,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,100,9,11,255,1,13,11,255,1,21,13,255,1,8,14,255,1,24,14,255,1,29,15,255,1,37,17,255,1,8,18,255,1,38,18,255,1,17,15,255,1,9,23,255,1,17,15,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,9,255,1,12,9,255,1,20,10,255,1,33,9,255,1,36,9,255,1,8,11,255,1,21,11,255,1,28,11,255,1,41,11,255,1,7,15,255,1,25,15,255,1,42,15,255,1,7,19,255,1,25,19,255,1,28,23,255,1,42,19,255,1,7,23,255,1,17,24,255,1,21,23,255,1,28,23,255,1,41,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,10,255,1,13,10,255,1,21,10,255,1,9,11,255,1,26,11,255,1,29,13,255,1,37,15,255,1,8,15,255,1,27,15,255,1,36,15,255,1,37,15,255,1,8,19,255,1,26,19,255,1,42,19,255,1,9,23,255,1,13,25,255,1,26,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,14,8,255,1,14,8,255,1,22,8,255,1,34,8,255,1,38,8,255,1,11,10,255,1,43,10,255,1,9,14,255,1,44,14,255,1,9,18,255,1,44,18,255,1,11,22,255,1,14,24,255,1,26,23,255,1,30,23,255,1,43,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,13,0,100,8,16,255,1,10,16,255,1,18,16,255,1,26,16,255,1,34,16,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,100,12,8,255,1,14,8,255,1,22,9,255,1,43,7,255,1,11,9,255,1,22,9,255,1,22,9,255,1,43,9,255,1,9,13,255,1,28,13,255,1,30,14,255,1,43,13,255,1,9,17,255,1,33,17,255,1,43,17,255,1,10,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,3,0,100,28,4,255,1,29,4,255,1,37,7,255,1,10,11,255,1,13,12,255,1,26,8,255,1,40,8,255,1,9,12,255,1,13,12,255,1,21,12,255,1,43,12,255,1,9,16,255,1,43,16,255,1,9,20,255,1,43,20,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,100,11,12,255,1,12,12,255,1,25,11,255,1,28,11,255,1,36,11,255,1,15,13,255,1,20,13,255,1,35,13,255,1,23,17,255,1,35,17,255,1,27,21,255,1,28,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,26,9,255,1,34,8,255,1,38,8,255,1,9,12,255,1,25,10,255,1,43,10,255,1,9,14,255,1,24,14,255,1,43,14,255,1,9,18,255,1,24,18,255,1,44,18,255,1,9,22,255,1,14,23,255,1,24,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,5,0,100,26,9,255,1,34,8,255,1,36,8,255,1,7,14,255,1,25,10,255,1,41,10,255,1,7,14,255,1,12,17,255,1,24,14,255,1,41,14,255,1,13,18,255,1,24,18,255,1,41,18,255,1,24,22,255,1,28,23,255,1,41,22,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,100,9,11,255,1,13,11,255,1,21,13,255,1,8,14,255,1,24,14,255,1,29,15,255,1,37,17,255,1,8,18,255,1,38,18,255,1,17,15,255,1,9,23,255,1,17,15,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,9,255,1,12,9,255,1,20,10,255,1,33,9,255,1,36,9,255,1,8,11,255,1,21,11,255,1,28,11,255,1,41,11,255,1,7,15,255,1,25,15,255,1,42,15,255,1,7,19,255,1,25,19,255,1,28,23,255,1,42,19,255,1,7,23,255,1,17,24,255,1,21,23,255,1,28,23,255,1,41,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,10,255,1,13,10,255,1,21,10,255,1,9,11,255,1,26,11,255,1,29,13,255,1,37,15,255,1,8,15,255,1,27,15,255,1,36,15,255,1,37,15,255,1,8,19,255,1,26,19,255,1,42,19,255,1,9,23,255,1,13,25,255,1,26,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,14,8,255,1,14,8,255,1,22,8,255,1,34,8,255,1,38,8,255,1,11,10,255,1,43,10,255,1,9,14,255,1,44,14,255,1,9,18,255,1,44,18,255,1,11,22,255,1,14,24,255,1,26,23,255,1,30,23,255,1,43,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,13,0,100,8,16,255,1,10,16,255,1,18,16,255,1,26,16,255,1,34,16,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,100,12,8,255,1,14,8,255,1,22,9,255,1,43,7,255,1,11,9,255,1,22,9,255,1,22,9,255,1,43,9,255,1,9,13,255,1,28,13,255,1,30,14,255,1,43,13,255,1,9,17,255,1,33,17,255,1,43,17,255,1,10,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,3,0,100,28,4,255,1,29,4,255,1,37,7,255,1,10,11,255,1,13,12,255,1,26,8,255,1,40,8,255,1,9,12,255,1,13,12,255,1,21,12,255,1,43,12,255,1,9,16,255,1,43,16,255,1,9,20,255,1,43,20,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,100,11,12,255,1,12,12,255,1,25,11,255,1,28,11,255,1,36,11,255,1,15,13,255,1,20,13,255,1,35,13,255,1,23,17,255,1,35,17,255,1,27,21,255,1,28,21,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,0,100,26,9,255,1,34,8,255,1,38,8,255,1,9,12,255,1,25,10,255,1,43,10,255,1,9,14,255,1,24,14,255,1,43,14,255,1,9,18,255,1,24,18,255,1,44,18,255,1,9,22,255,1,14,23,255,1,24,22,255,1,26,6,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,5,0,100,26,9,255,1,34,8,255,1,36,8,255,1,7,14,255,1,25,10,255,1,41,10,255,1,7,14,255,1,12,17,255,1,24,14,255,1,41,14,255,1,13,18,255,1,24,18,255,1,41,18,255,1,24,22,255,1,28,23,255,1,41,22,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0,100,9,11,255,1,13,11,255,1,21,13,255,1,8,14,255,1,24,14,255,1,29,15,255,1,37,17,255,1,8,18,255,1,38,18,255,1,17,15,255,1,9,23,255,1,17,15,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,9,255,1,12,9,255,1,20,10,255,1,33,9,255,1,36,9,255,1,8,11,255,1,21,11,255,1,28,11,255,1,41,11,255,1,7,15,255,1,25,15,255,1,42,15,255,1,7,19,255,1,25,19,255,1,28,23,255,1,42,19,255,1,7,23,255,1,17,24,255,1,21,23,255,1,28,23,255,1,41,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,100,11,10,255,1,13,10,255,1,21,10,255,1,9,11,255,1,26,11,255,1,29,13,255,1,37,15,255,1,8,15,255,1,27,15,255,1,36,15,255,1,37,15,255,1,8,19,255,1,26,19,255,1,42,19,255,1,9,23,255,1,13,25,255,1,26,23,255,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

	
static void sys_image_var_init()
{
	 //需要判断(x,y)的相对大小
  //cass_mv_boarder_width = image_data_packet_desc.roi_desc.x_end - image_data_packet_desc.roi_desc.x_start;
	//cass_mv_boarder_height = image_data_packet_desc.roi_desc.y_end - image_data_packet_desc.roi_desc.y_start;
	//cass_mv_boarder_leftbound=image_data_packet_desc.roi_desc.x_start;
	//endx=image_data_packet_desc.roi_desc.x_end;
	//cass_mv_boarder_topbound=image_data_packet_desc.roi_desc.y_start;
	//endy=image_data_packet_desc.roi_desc.y_end;
	
	cass_mv_boarder_topbound=image_data_packet_desc.space[0].topbound;
	cass_mv_boarder_leftbound=image_data_packet_desc.space[0].leftbound;
	
	cass_mv_boarder_height=image_data_packet_desc.space[0].height;
	cass_mv_boarder_width=image_data_packet_desc.space[0].width;
	
}

void Camera_refresh()
{
	u32 x,y;
	u16 color,gray,red,green,blue;
	
	if(ov_sta==2)
	{			
		OV7670_RRST=0;				//开始复位读指针 
		OV7670_RCK=0;
		OV7670_RCK=1;
		OV7670_RCK=0;
		OV7670_RRST=1;				//复位读指针结束 
		OV7670_RCK=1;  	
		
 		for(y=0;y<240;y++)//宽
		{
			for(x=0;x<320;x++)//高
			{
				OV7670_RCK=0;
				color=GPIOC->IDR&0XFF;	//读数据
				OV7670_RCK=1; 
				color<<=8;  
				OV7670_RCK=0;
				color|=GPIOC->IDR&0XFF;	//读数据
				OV7670_RCK=1; 
				
				red = (color>>11) & 0x1f;
				green = (color>>5) & 0x3f;
				blue = color & 0x1f;					
				red   = (red<<3) | (red & 0x7);
				green = (green<<2) | (green & 0x3);
				blue  = (blue<<3) | (blue & 0x7);
				
				gray = (u16)((red*1224+green*2404+blue*467)>>12);
				raw_data[y*320+x]=gray;
			}
		}		
 		EXTI->PR=1<<8;     			//清除LINE8上的中断标志位
		ov_sta=0;					//开始下一次采集
 		ov_frame++; 
		
		for(y=0;y<240;y++)
			for(x=0;x<320;x++)
			{
					//out_data[(y-cass_mv_boarder_topbound)*320+x-cass_mv_boarder_leftbound]=raw_data[y*320+x];
				out_data[y*320+x]=raw_data[y*320+x];
			}	
	} 
}	


 
 
/*滤波函数*/
uint8 Gaussian(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u16 x=0,y=0,scanline=320;
	u16 cur_value=0;
	u8	value=0;
	u8  v[9];
	static u8 win[9] = {1,2,1,2,4,2,1,2,1};
	
	for(y=0;y<cass_mv_boarder_height;y++)  
		for (x=0;x<cass_mv_boarder_width;x++)
		{ 		
			v[0] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound-1];//有边缘隐患，如果是对全图或者边缘处理有危险。
			v[1] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound];
			v[2] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound+1];
			v[3] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
			v[4] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
			v[5] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
			v[6] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound-1];
			v[7] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound];
			v[8] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound+1];
			
			cur_value = win[0]*v[0] + win[1]*v[1] + win[2]*v[2]
          + win[3]*v[3] + win[4]*v[4] + win[5]*v[5]
          + win[6]*v[6] + win[7]*v[7] + win[8]*v[8];
			value = (u8)(cur_value>>4);
			out_data[(y+cass_mv_boarder_topbound)*scanline+(x+cass_mv_boarder_leftbound)]=value;
    }
	 
	memcpy(raw_data,out_data,240*scanline);//可以改为就复制选取区域的一部分，会更快
	return 1;
}

uint8 Mean(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u16 x=0,y=0,scanline=320;
	u16 cur_value=0;
	u8	value=0;
	u8  v[9];

	for(y=0;y<cass_mv_boarder_height;y++)  
		for (x=0;x<cass_mv_boarder_width;x++)
		{ 		
			v[0] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound-1];//有边缘隐患，如果是对全图或者边缘处理有危险。
			v[1] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound];
			v[2] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound+1];
			v[3] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
			v[4] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
			v[5] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
			v[6] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound-1];
			v[7] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound];
			v[8] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound+1];
			
			cur_value =  v[0] + v[1] + v[2]+ v[3] + v[4] + v[5]+ v[6] + v[7] + v[8];
			value = (u8)(cur_value>>4);
			out_data[(y+cass_mv_boarder_topbound)*scanline+(x+cass_mv_boarder_leftbound)]=value;
    }
	 
	memcpy(raw_data,out_data,240*scanline);//可以改为就复制选取区域的一部分，会更快
	return 1;
}

uint8 Laplace(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u16 x=0,y=0,scanline=320;
	u16 cur_value=0;
	u8	value=0;
	u8  v[9];
	static int win[9] = {0,1,0,1,-4,1,0,1,0};
	
	for(y=0;y<cass_mv_boarder_height;y++)  
		for (x=0;x<cass_mv_boarder_width;x++)
		{ 		
			v[0] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound-1];//有边缘隐患，如果是对全图或者边缘处理有危险。
			v[1] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound];
			v[2] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound+1];
			v[3] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
			v[4] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
			v[5] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
			v[6] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound-1];
			v[7] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound];
			v[8] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound+1];
			
			cur_value = win[0]*v[0] + win[1]*v[1] + win[2]*v[2]
						+ win[3]*v[3] + win[4]*v[4] + win[5]*v[5]
						+ win[6]*v[6] + win[7]*v[7] + win[8]*v[8];
			value = (u8)(cur_value>>4);
			out_data[(y+cass_mv_boarder_topbound)*scanline+(x+cass_mv_boarder_leftbound)]=value;
		}
	 
	memcpy(raw_data,out_data,240*scanline);//可以改为就复制选取区域的一部分，会更快
	return 1;
}

uint8 MediaFilter(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u16 x=0,y=0,scanline=320;
	u8  v[9],ii,jj,m,n,min,k,temp;
	
	for(y=0;y<cass_mv_boarder_height;y++)  
		for (x=0;x<cass_mv_boarder_width;x++)
		{
			if(y==cass_mv_boarder_topbound||y==cass_mv_boarder_topbound+cass_mv_boarder_height-1)
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
			else if(x==cass_mv_boarder_leftbound||x==cass_mv_boarder_leftbound+cass_mv_boarder_width-1)
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
			else
			{
				k=0;
				for (jj=y-1;jj < y+2; ++jj)
					for ( ii=x-1;ii < x+2; ++ii)
					{
						v[k++] = raw_data[(jj+cass_mv_boarder_topbound) * scanline +cass_mv_boarder_leftbound + ii];
					}
				for ( m = 0; m < 5; ++m)
				{
					  min = m;
					  for ( n = m + 1; n < 9; ++n)
					  {
							if (v[n] < v[min])
							min = n;
					  }
					  temp = v[m];
					  v[m] = v[min];
					  v[min] = temp;
				}  
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound] = v[4];
			}				
		}
		
	memcpy(raw_data,out_data,240*scanline);//可以改为就复制选取区域的一部分，会更快
	return 1;
 }
 
uint8 Sobel(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	int x,y,scanline=320;
	int sumx,sumy,sum;
	u8 v[9];    
	static int winy[9] = { -1,-2,-1,0,0,0,1,2,1};
	static int winx[9] = { -1,0,1,-2,0,2,-1,0,1};

	for (y=0;y<cass_mv_boarder_height;y++)
	{
		for (x=0;x<cass_mv_boarder_width;x++)
		{
			sumx=0;
			sumy=0;
			if(y==0||y==cass_mv_boarder_height-1)
				sum=0;
			else if(x==0||x==cass_mv_boarder_width-1)
				sum=0;
			else
			{
				v[0] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound-1];
				v[1] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound];
				v[2] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound+1];
				v[3] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
				v[4] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
				v[5] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
				v[6] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound-1];
				v[7] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound];
				v[8] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound+1];

				sumx = winx[0]*v[0] + winx[1]*v[1] + winx[2]*v[2]
					   + winx[3]*v[3] + winx[4]*v[4] + winx[5]*v[5]
					   + winx[6]*v[6] + winx[7]*v[7] + winx[8]*v[8];

				sumx = (int)(sumx/16);
				if(sumx>255)  
					sumx=255;
				if(sumx<0)    
					sumx=0;

				sumy = winy[0]*v[0] + winy[1]*v[1] + winy[2]*v[2]
					   + winy[3]*v[3] + winy[4]*v[4] + winy[5]*v[5]
					   + winy[6]*v[6] + winy[7]*v[7] + winy[8]*v[8];
				sumy = (int)(sumy/16);
				if(sumy>255)  
					sumx=255;
				if(sumy<0)    
					sumx=0;
				
				sum=(int)sqrt((float)(sumx*sumx+sumy*sumy));				
			}	
			//out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255-(u8)sum;
			if(sum>5)
					out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255;
			else
					out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=0;
		}
  }
	memcpy(raw_data,out_data,scanline*240);
	return 1;
}

uint8 Prewitt(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	int x,y,scanline=320;
	int sumx,sumy,sum;
	u8 v[9];
        
	static int winy[9] = { -1,0,1,-1,0,1,-1,0,1};
	static int winx[9] = { -1,-1,1,0,0,0,1,1,1};

	for (y=0;y<cass_mv_boarder_height;y++)
	{
		for (x=0;x<cass_mv_boarder_width;x++)
		{
			sumx=0;
			sumy=0;
			if(y==0||y==cass_mv_boarder_height-1)
				sum=0;
			else if(x==0||x==cass_mv_boarder_width-1)
				sum=0;
			else
			{
				v[0] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound-1];
				v[1] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound];
				v[2] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound+1];
				v[3] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
				v[4] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
				v[5] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
				v[6] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound-1];
				v[7] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound];
				v[8] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound+1];

				sumx = winx[0]*v[0] + winx[1]*v[1] + winx[2]*v[2]
				+ winx[3]*v[3] + winx[4]*v[4] + winx[5]*v[5]
				+ winx[6]*v[6] + winx[7]*v[7] + winx[8]*v[8];

				sumx = (int)(sumx/16);
				if(sumx>255)  
					sumx=255;
				if(sumx<0)    
					sumx=0;

				sumy = winy[0]*v[0] + winy[1]*v[1] + winy[2]*v[2]
				+ winy[3]*v[3] + winy[4]*v[4] + winy[5]*v[5]
				+ winy[6]*v[6] + winy[7]*v[7] + winy[8]*v[8];
				sumy = (int)(sumy/16);
				if(sumy>255)  
					sumx=255;
				if(sumy<0)    
					sumx=0;
				
				sum=(int)sqrt((float)(sumx*sumx+sumy*sumy));				
			}	
			//out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255-(u8)sum;
			if(sum>50)
					out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255;
			else
					out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=0;
		}
	}
	
	memcpy(raw_data,out_data,scanline*240);
	return 1;
}



/*色彩*/ 
u8 AntiColor(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u16 x=0,y=0,scanline=320;
	
	for(y=0;y<cass_mv_boarder_height;y++)  
		for (x=0;x<cass_mv_boarder_width;x++)	
		{
			out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255-raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
		}

	memcpy(raw_data,out_data,240*scanline);//可以改为就复制选取区域的一部分，会更快
	return 1;
}	

u8 Hisgram(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u16 x=0,y=0,scanline=320;
	u16 max,min;
	float p[256]={0},c[256]={0},count=0;
	int n[256]={0};
	
	for(y=0;y<cass_mv_boarder_height;y++)  
		for (x=0;x<cass_mv_boarder_width;x++)	
		{
			n[raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]]++;
			count++;
		}
	
    for(x=0;x<256;x++)
	        p[x]=(float)n[x]/(float)(cass_mv_boarder_width*cass_mv_boarder_height);


	for(x=0;x<256;x++)
     for(y=0;y<=x;y++)
	{
          c[x]+=p[y];
    }

	max=min=raw_data[cass_mv_boarder_topbound*scanline+cass_mv_boarder_leftbound];
	for(y=0;y<cass_mv_boarder_height;y++)
	{
     for(x=0;x<cass_mv_boarder_width;x++)
	   {
		   if(max<raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound])
			{
			   max=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
			}
			else if(min>raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound])
			{
			  min=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
			}
	 }
   }

	for(y=0;y<cass_mv_boarder_height;y++)
		for(x=0;x<cass_mv_boarder_width;x++)
		{
		  out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=c[raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]]*(max-min)+min;
		}
	
	memcpy(raw_data,out_data,240*scanline);//可以改为就复制选取区域的一部分，会更快
	return 1;
}

u8 Ostu_Program(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{  
   u8 x,y,i,j;
   u16 scanline,thresh_value;
   double piexlsum,greyscale;
   float piexlcount[255];
   float piexlpercent[255];
   float w0,w1,u0tmp,u1tmp,u0,u1,u,deltaTmp,deltaMax;

   thresh_value=0;
   greyscale=255;
   deltaMax=0;
   
   scanline=320;
   //height=240;

   piexlsum=cass_mv_boarder_width*cass_mv_boarder_height;//总像素

   memset(piexlcount,0,sizeof(piexlcount));
   memset(piexlpercent,0,sizeof(piexlpercent));

   for (y=0;y<cass_mv_boarder_height;y++)  
      for (x=0;x<cass_mv_boarder_width;x++)
	  { 
			piexlcount[(int)raw_data[(y+cass_mv_boarder_topbound)*scanline+(x+cass_mv_boarder_leftbound)]]++;//每级灰度的像素个数
      }
      
   for(i=0;i<greyscale;i++)
   {
      piexlpercent[i]=(float)piexlcount[i]/piexlsum;//每级灰度的像素占总像素数比率
   }
   
   for(i=0;i<greyscale;i++)//阈值扫描
   {
     w0=w1=u0tmp=u1tmp=u0=u1=u=deltaTmp=0;
     for(j=0;j<greyscale;j++)
     {
      if(j<i)
      {
        w0+=piexlpercent[j];//前景像素占总像素比率
        u0tmp+=j*piexlpercent[j];//前景像素灰度平均值
      }
      else
      {
        w1+=piexlpercent[j];//背景像素占总像素比率
        u1tmp+=j*piexlpercent[j];//背景像素灰度平均值
      }
     }
     u0=u0tmp/w0;//前景像素灰度平均值
     u1=u1tmp/w1;//背景像素灰度平均值
     u=u0tmp+u1tmp;//所有像素灰度平均值
     deltaTmp=w0*pow((u0-u),2)+w1*pow((u1-u),2);//前景背景差距=w0(u0-u)^2+w1(u1-u)^2
     if(deltaTmp>deltaMax)//最大的deltaMax时，前景背景差异最大
     {
       deltaMax=deltaTmp;
       thresh_value=i;
     }   
   }  
   
   for (y=0;y<cass_mv_boarder_height;y++)  
	{
		for (x=0;x<cass_mv_boarder_width;x++)
		{ 		
			if(raw_data[(y+cass_mv_boarder_topbound)*scanline+(x+cass_mv_boarder_leftbound)]<thresh_value)
				out_data[(y+cass_mv_boarder_topbound)*scanline+(x+cass_mv_boarder_leftbound)]=0;
			else
				out_data[(y+cass_mv_boarder_topbound)*scanline+(x+cass_mv_boarder_leftbound)]=255;
    }
	} 

	memcpy(raw_data,out_data,240*scanline);//可以改为就复制选取区域的一部分，会更快
   return 1;
}

u8 Binary(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u16 x=0,y=0,scanline=320;
	
	for(y=0;y<cass_mv_boarder_height;y++)  
		for (x=0;x<cass_mv_boarder_width;x++)	
		{
			if(raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]<128)
				raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=0;	
			else
				raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255;				
		}
		
	return 1;
}



u8 Grayscale(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	int x,y,sum,scanline=320;
	u8 map[256]={0};
	double dTemp;
	float cass_mv_left_gray_in=50,cass_mv_right_gray_in=100,cass_mv_left_gray_out=20,cass_mv_right_gray_out=200;

	for(x=0;x<256;x++)
	{
		// 如果在第一条直线上
		if ( x < cass_mv_left_gray_in)
		{
			if ( fabs(cass_mv_left_gray_in - 0) > 0.0001 )
				dTemp = (float)cass_mv_left_gray_out / (float)cass_mv_left_gray_in * x;
			else
				dTemp = 0;
		}
		// 如果在第二条直线上
		else if ( x <= cass_mv_right_gray_in )
		{
			if ( fabs(cass_mv_right_gray_in - cass_mv_left_gray_in) > 0.0001 )
				dTemp = (float)(cass_mv_right_gray_out - cass_mv_left_gray_out) / (float)(cass_mv_right_gray_in - cass_mv_left_gray_in) * (x - cass_mv_left_gray_in) + cass_mv_left_gray_out;
			else
				dTemp = x;
		}
		// 如果在第三条直线上
		else
		{
			if ( fabs(cass_mv_right_gray_out - 255) > 0.0001 )
				dTemp = (float)(255 - cass_mv_right_gray_out) / (float)(255 - cass_mv_right_gray_in) * (x - cass_mv_right_gray_in) + cass_mv_right_gray_out;
			else
				dTemp = 255;
		}

		// 四舍五入
		map[x] = (int)(dTemp + 0.5);
	}

	for(y=0;y<cass_mv_boarder_height;y++)
		for(x=0;x<cass_mv_boarder_width;x++)
		{
			out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=map[raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]];
		}
	
	memcpy(raw_data,out_data,240*scanline);//可以改为就复制选取区域的一部分，会更快
	return 1;
}


/*形态学*/
u8 Denosing_Program(int cass_mv_boarder_topbound ,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	int x,y,m,n,sum=0;
	int scanline=320;
		
	for (y=cass_mv_boarder_topbound;y<cass_mv_boarder_topbound+cass_mv_boarder_height;y++)
  {
		for (x=cass_mv_boarder_leftbound;x<cass_mv_boarder_leftbound+cass_mv_boarder_width;x++)
		{
			sum=0;
			if(y==cass_mv_boarder_topbound||y==cass_mv_boarder_topbound+cass_mv_boarder_height-1)
				out_data[y*scanline+x]=0;
			else if(x==cass_mv_boarder_leftbound||x==cass_mv_boarder_leftbound+cass_mv_boarder_width-1)
				out_data[y*scanline+x]=0;
			else
			{
				if(raw_data[y*scanline+x]==255)
				{
					for( m = y-1; m<y+2; m++)
					{
						for( n = x-1;n<x+2; n++ )
						{
							if(out_data[m*scanline+n]==255)
							{  
							   sum++;
							}
						}
					}                             //sum记录黑点的个数
					if(sum < 5 )   
						out_data[y*scanline+x]=0;
				}
			}
		}
	}
	
	memcpy(raw_data,out_data,240*scanline);//可以改为就复制选取区域的一部分，会更快 
	return 1;
}

u8 Thin(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)//边缘有问题，会粘连
{
  u16 neighbor[8];
	u16 x=0,y=0,scanline=320;
	int loop=1;
  int markNum=0;
	int np,sp,i;
	
  while(loop)
  {
       loop=0;
 
       //第一步
       markNum=0;
       for(y=1;y<cass_mv_boarder_height-1;y++)
       {
           for(x=1;x<cass_mv_boarder_width-1;x++)
           {
              //条件1：p必须是前景点
              if(raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]==0 ) 
				  continue;
 
              neighbor[0]= raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1] ;
              neighbor[1]= raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound+1];
              neighbor[2]= raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound];
              neighbor[3]= raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound-1];
              neighbor[4]= raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
              neighbor[5]= raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound-1];
              neighbor[6]= raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound];
              neighbor[7]= raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound+1];
 
              //条件2：2<=N(p)<=6
              np=(neighbor[0]+neighbor[1]+neighbor[2]+neighbor[3]+neighbor[4]+neighbor[5]+neighbor[6]+neighbor[7])/255;
              if(np<2 || np>6) 
				continue;
 
              //条件3：S(p）=1
              sp=0;
              for( i=1;i<8;i++)
              {
                  if(neighbor[i]-neighbor[i-1]==255)
                     sp++;
              }
              if(neighbor[0]-neighbor[7]==255)
                sp++;            
              if(sp!=1) 
				continue;
 
              //条件4：p2*p0*p6=0
              if(neighbor[2]&neighbor[0]&neighbor[6]!=0)
                  continue;
                //条件5：p0*p6*p4=0
              if(neighbor[0]&neighbor[6]&neighbor[4]!=0)
                  continue;
 
              //标记删除
              out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=1;   
              markNum++;
              loop=1;
           }
				}
 
       //将标记删除的点置为背景色
       if(markNum>0)
       {
           for(y=0;y<cass_mv_boarder_height;y++)
              for(x=0;x<cass_mv_boarder_width;x++)
              {
                 // k=y*w+x;
                  if(out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]==1)
                  {
                     raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=0;
                  }
              }           
       }
      
 
       //第二步
        markNum=0;
       for(y=1;y<cass_mv_boarder_height-1;y++)
       {
           for(x=1;x<cass_mv_boarder_width-1;x++)
           {
              //条件1：p必须是前景点
              if(raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]==0 ) continue;
 
              neighbor[0]= raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1] ;
              neighbor[1]= raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound+1];
              neighbor[2]= raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound];
              neighbor[3]= raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound-1];
              neighbor[4]= raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
              neighbor[5]= raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound-1];
              neighbor[6]= raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound];
              neighbor[7]= raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound+1];
 
              //条件2：<=N(p)<=6
               np=(neighbor[0]+neighbor[1]+neighbor[2]+neighbor[3]+neighbor[4]+neighbor[5]+neighbor[6]+neighbor[7])/255;
              if(np<2 || np>6)
					continue;
 
              //条件3：S(p)=1
               sp=0;
              for( i=1;i<8;i++)
              {
                  if(neighbor[i]-neighbor[i-1]==255)
                     sp++;
              }
              if(neighbor[0]-neighbor[7]==255)
                  sp++;
              if(sp!=1) 
				continue;
 
              //条件4：p2*p0*p4==0
              if(neighbor[2]&neighbor[0]&neighbor[4]!=0)
                  continue;
              //条件5：p2*p6*p4==0
              if(neighbor[2]&neighbor[6]&neighbor[4]!=0)
                  continue;
 
              //标记删除
             out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=1;   
              markNum++;
              loop=1;
           }
       }
 
       //将标记删除的点置为背景色
       if(markNum>0)
       {
           for(y=0;y<cass_mv_boarder_height;y++)
              for(x=0;x<cass_mv_boarder_width;x++)
              {
                 // k=y*w+x;
                  if(out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]==1)
                  {
                     raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=0;
                  }
              }     
       }
     
  } 
	return 1;
}




uint8 Erode(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)//前景点(白)会减少，背景点(黑色)增加
{
  u16 scanline=320,k,x,y;
	u8 flag;
  u8 pix[5];

	for(y=1;y<cass_mv_boarder_height-1;y++)                                      
	{
    for(x=1;x<cass_mv_boarder_width-1;x++)
		{
		  flag=1;
		  pix[0]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
		  pix[1]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-2];
		  pix[2]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
		  pix[3]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
		  pix[4]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+2];
        
		for(k=0;k<5;k++)
		{
			if((pix[0]==0)||(pix[k]==0))
			{
				flag=0;
				break;
			}
			if(flag==0)
			{
				break;
			}
		}
		if(flag==0)
			out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=0;		
		else	
			out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255;			
		}
	}
	
 	memcpy(raw_data,out_data,scanline*240);
	return 1;
}

uint8 Dialate(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
  u8 k;
  u16 y,x,scanline=320;
  u8 flag;
  u8 pix[5];

	for(y=0;y<cass_mv_boarder_height;y++)  
		for (x=0;x<cass_mv_boarder_width;x++)
		{
		  flag=1;
		  pix[0]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
		  pix[1]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-2];
		  pix[2]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
		  pix[3]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
		  pix[4]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];

		  for(k=0;k<5;k++)
		  {
			if((pix[0]==255)||(pix[k]==255))
			{
				flag=0;
				break;
			}
			if(flag==0)
			{
				break;
			}
		  }
		  if(flag==0)
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255;
		  else
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=0;
		}

  memcpy(raw_data,out_data,scanline*240);
		return 1;
}

uint8 Open(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u16 scanline=320,k,x,y;
	u8 flag;
  u8 pix[5];

	for(y=1;y<cass_mv_boarder_height-1;y++)                                      
	{
    for(x=1;x<cass_mv_boarder_width-1;x++)
		{
			flag=1;
		  pix[0]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
		  pix[1]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-2];
		  pix[2]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
		  pix[3]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
		  pix[4]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+2];
        
			for(k=0;k<5;k++)
			{
				if((pix[0]==0)||(pix[k]==0))
				{
					flag=0;
					break;
				}
				if(flag==0)
				{
					break;
				}
			}
			if(flag==0)
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=0;		
			else	
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255;			
		}
	}
	
	for(y=0;y<cass_mv_boarder_height;y++)  
		for (x=0;x<cass_mv_boarder_width;x++)
		{
		  flag=1;
		  pix[0]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
		  pix[1]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-2];
		  pix[2]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
		  pix[3]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
		  pix[4]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];

		  for(k=0;k<5;k++)
		  {
			if((pix[0]==255)||(pix[k]==255))
			{
				flag=0;
				break;
			}
			if(flag==0)
			{
				break;
			}
		  }
		  if(flag==0)
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255;
		  else
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=0;
		}

  memcpy(raw_data,out_data,scanline*240);
		return 1;	
}

uint8 Close(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u8 k;
  u16 y,x,scanline=320;
  u8 flag;
  u8 pix[5];

	for(y=0;y<cass_mv_boarder_height;y++)  
		for (x=0;x<cass_mv_boarder_width;x++)
		{
		  flag=1;
		  pix[0]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
		  pix[1]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-2];
		  pix[2]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
		  pix[3]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
		  pix[4]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];

		  for(k=0;k<5;k++)
		  {
			if((pix[0]==255)||(pix[k]==255))
			{
				flag=0;
				break;
			}
			if(flag==0)
			{
				break;
			}
		  }
		  if(flag==0)
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255;
		  else
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=0;
		}
		
		for(y=1;y<cass_mv_boarder_height-1;y++)                                      
	{
    for(x=1;x<cass_mv_boarder_width-1;x++)
		{
			flag=1;
		  pix[0]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
		  pix[1]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-2];
		  pix[2]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
		  pix[3]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
		  pix[4]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+2];
        
			for(k=0;k<5;k++)
			{
				if((pix[0]==0)||(pix[k]==0))
				{
					flag=0;
					break;
				}
				if(flag==0)
				{
					break;
				}
			}
			if(flag==0)
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=0;		
			else	
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255;			
		}
	}
 	memcpy(raw_data,out_data,scanline*240);
	return 1;
		
}	
	

uint8 InClean(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u16 x,y,sum,scanline=320;
  u8 v[9];

	for (y=0 ;y<cass_mv_boarder_height;y++)
		for (x=0;x<cass_mv_boarder_width;x++)
    {
			  if(y==0||y==cass_mv_boarder_height-1)
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
			  else if(x==0||x==cass_mv_boarder_width-1)
				out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
			  else
			  {
				if(raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]==0)
				{
				  v[0] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound-1];
				  v[1] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound];
				  v[2] = raw_data[(y+cass_mv_boarder_topbound-1)*scanline+x+cass_mv_boarder_leftbound+1];
				  v[3] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound-1];
				  v[4] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
				  v[5] = raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound+1];
				  v[6] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound-1];
				  v[7] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound];
				  v[8] = raw_data[(y+cass_mv_boarder_topbound+1)*scanline+x+cass_mv_boarder_leftbound+1];

				  if(v[0]+v[1]+v[2]+v[3]+v[5]+v[6]+v[7]+v[8]==0)
					out_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound]=255;
				}
			  }
		}
    
		memcpy(raw_data,out_data,scanline*240);		  
		return 1;		  
}



/*计算*/
uint8 Gravity(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u16 x,y,scanline=320;
	double s00=0,s10=0,s01=0;//0阶矩和1阶矩
	u16 Center_x=0,Center_y=0;//重心坐标

	for (y=0;y<cass_mv_boarder_height;y++)
	{
		for (x=0;x<cass_mv_boarder_width;x++)
		{
			s00+=raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
			s10+=x*raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
			s01+=y*raw_data[(y+cass_mv_boarder_topbound)*scanline+x+cass_mv_boarder_leftbound];
		}
	}

	Center_x=(s10/s00+0.5);
	Center_y=(s01/s00+0.5);
	raw_data[(Center_y+cass_mv_boarder_topbound-1)*scanline+Center_x+cass_mv_boarder_leftbound-1]=128;
	raw_data[(Center_y+cass_mv_boarder_topbound-1)*scanline+Center_x+cass_mv_boarder_leftbound]=128;
	raw_data[(Center_y+cass_mv_boarder_topbound-1)*scanline+Center_x+cass_mv_boarder_leftbound+1]=128;
	raw_data[(Center_y+cass_mv_boarder_topbound)*scanline+Center_x+cass_mv_boarder_leftbound-1]=128;
	raw_data[(Center_y+cass_mv_boarder_topbound)*scanline+Center_x+cass_mv_boarder_leftbound]=128;
	raw_data[(Center_y+cass_mv_boarder_topbound)*scanline+Center_x+cass_mv_boarder_leftbound+1]=128;
	raw_data[(Center_y+cass_mv_boarder_topbound+1)*scanline+Center_x+cass_mv_boarder_leftbound-1]=128;
	raw_data[(Center_y+cass_mv_boarder_topbound+1)*scanline+Center_x+cass_mv_boarder_leftbound]=128;
	raw_data[(Center_y+cass_mv_boarder_topbound+1)*scanline+Center_x+cass_mv_boarder_leftbound+1]=128;
	return 1;
}


u16 small_leftbound_find(u16 startx,u16 starty,u16 small_height,u16 small_width)
{
	int leftbound=0,scanline,count=0;
	int i,j;		

	scanline=320;
	
	for(i=startx;i<startx+small_width;i++)
	{	
		count=0;
		for(j=starty;j<starty+small_height;j++)
		{
			if(out_data[j*scanline+i]==255)
				count++;
		}
		if(count>0)
		{
			leftbound=i;
			break;
		}
	}
	return leftbound;
}
u16 small_rightbound_find(int startx,int starty,int small_height,int small_width)
{
	int rightbound=0,scanline,count=0;
	int i,j;	
	
	scanline=320;

	for(i=startx+small_width-1;i>=startx;i--)
	{
		count=0;
		for(j=starty;j<starty+small_height;j++)
		{
			if(out_data[j*scanline+i]==255)
				count++;
		}
		if(count>0)
		{
			rightbound=i;//LCD下边
			break;
		}
	}
	return rightbound;
}	
u16 small_topbound_find(int startx,int starty,int small_height,int small_width)
{
	int topbound=0,scanline,count=0;
	int i,j;		
	scanline=320;

	for(j=starty;j<starty+small_height;j++)
	{
		count=0;
		for(i=startx;i<startx+small_width;i++)
		{
			
			if(out_data[j*scanline+i]==255)
				count++;
		}
		if(count>0)
		{
			topbound=j;//LCD左边
			break;
		}
	}
	return topbound;
}
u16 small_downbound_find(int startx,int starty,int small_height,int small_width)
{
	int downbound=0,scanline,count=0;
	int i,j;		

	scanline=320;
	
	for(j=starty+small_height-1;j>=starty;j--)
	{
		count=0;
		for(i=startx;i<startx+small_width;i++)
		{
			if(out_data[j*scanline+i]==255)
				count++;
		}
		if(count>0)
		{
			downbound=j;//LCD右边
			break;
		}
	}
	return downbound;
}

/*匹配函数*/
uint8 Match(int cass_mv_boarder_topbound,int cass_mv_boarder_leftbound,int cass_mv_boarder_height,int cass_mv_boarder_width)
{
	u16 tempx,tempy,tempvalue,tempdot,temp,i,j,scanline=320;
	u16 compare_sum[10]={0},correct_sum[10]={0};
	u16	max,maxnumber;
	u16 small_leftbound=0,small_rightbound=0,small_topbound=0,small_downbound=0;//待检测区域内的框住数字最小框
	u16 small_temp_leftbound,small_temp_topbound;//模板中的数字最小框左上角
	u16 temp_topbound,temp_leftbound;//待识别区域左上角
	
 	for(i=0;i<10;i++)
	{
		int temp_sum=0;
		for( j=0;j<30;j++)
		{
			temp=abs(image_data_packet_desc.space[0].point[i*30+j].w);
			if(temp!=100)//权值为100的点为模板中数字的左上，右下点，
				temp_sum+=temp;
		}
		correct_sum[i]=temp_sum;
	}

	
	/*待识别区域左上角*/
	temp_topbound=cass_mv_boarder_topbound;
	temp_leftbound=cass_mv_boarder_leftbound;

	/*找到待识别区域内读数最小框*/
	small_leftbound=small_leftbound_find(cass_mv_boarder_leftbound,cass_mv_boarder_topbound,cass_mv_boarder_height,cass_mv_boarder_width);/*注意参数顺序，和之前二值化 去噪相反*/
	small_topbound=small_topbound_find(cass_mv_boarder_leftbound,cass_mv_boarder_topbound,cass_mv_boarder_height,cass_mv_boarder_width);
	small_rightbound=small_rightbound_find(cass_mv_boarder_leftbound,cass_mv_boarder_topbound,cass_mv_boarder_height,cass_mv_boarder_width);
	small_downbound=small_downbound_find(cass_mv_boarder_leftbound,cass_mv_boarder_topbound,cass_mv_boarder_height,cass_mv_boarder_width);
	
	if(((small_rightbound-small_leftbound)/(small_downbound-small_topbound))>3)
		return 1;//最小框长宽比大于3，直接识别为数字1
	else
	{
		for(i=0;i<10;i++)
		{
			int value_sum=0;
			/*模板内的数字最小框左上角*/
			if(image_data_packet_desc.space[0].point[i*30].w==100)//100是确保坐标是最小框左上角
			{
				small_temp_topbound=image_data_packet_desc.space[0].point[i*30].y;
				small_temp_leftbound=image_data_packet_desc.space[0].point[i*30].x;	 
			}

			if(i==1)
			{
				compare_sum[1]=0;
				continue;
			}

			for(j=1;j<30;j++)
			{
				tempx=image_data_packet_desc.space[0].point[i*30+j].x-small_temp_leftbound;//相对坐标：坐标系为模板中数字最小框
				tempy=image_data_packet_desc.space[0].point[i*30+j].y-small_temp_topbound;
				tempdot=image_data_packet_desc.space[0].point[i*30+j].v;
				tempvalue=abs(image_data_packet_desc.space[0].point[i*30+j].w);
				
				if((image_data_packet_desc.space[0].point[i*30+j].w)!=0)//不是空点
					if(out_data[(small_topbound+tempy)*scanline+(small_leftbound+tempx)]==tempdot)//待识别区域中 数字最小框左上角 加上 特征点相对坐标
						value_sum+=tempvalue;
			}
			compare_sum[i]=value_sum;
		}

		for(i=0;i<10;i++)//算百分比
		{
			if(correct_sum[i])
				compare_sum[i]=compare_sum[i]*100/correct_sum[i];
		}
		
		/*找和第x模板最近似*/
		max=compare_sum[0];
		maxnumber=0;
		for(i=0;i<10;i++)
		{
			if(max<=compare_sum[i])
			{
				max=compare_sum[i];
				maxnumber=i;
			}
		}

		return maxnumber;
	}
 }

int main(void)
{
	u32 i,j;
	u16 space_leftbound[10]={0},space_topbound[10]={0};
	u8 correct_number;	
	u16 height,width;
	u16 x_leftbound=0,x_topbound=0;
	
	Stm32_Clock_Init(9);	//系统时钟设置	
	sys_image_var_init();
	uart_init(72,115200); 	//串口1初始化  
	delay_init(72);			//延时初始化	
	LCD_Init();				//初始化液晶 
	FSMC_SRAM_Init();
	if(lcddev.id==0X6804) 	//强制设置屏幕分辨率为320*240.以支持3.5寸大屏
	{
		lcddev.width=240;
		lcddev.height=320; 
	} 
  													   		 	
	while(OV7670_Init())//初始化OV7670
	{
 		delay_ms(200);
 	  LCD_Fill(60,190,239,206,WHITE);
 		delay_ms(200);
	}
	
	/*调整OV7670效果*/
	OV7670_Light_Mode(lightmode);
	OV7670_Color_Saturation(saturation);
	OV7670_Brightness(brightness);
	OV7670_Contrast(contrast);
 	OV7670_Special_Effects(effect);	 	
	
	TIM3_Int_Init(9,7199);//10Khz的计数频率，计数到10为1ms  
	TIM6_Int_Init(10000,7199);			//10Khz计数频率,1秒钟中断									  
	EXTI8_Init();						//使能定时器捕获
	OV7670_Window_Set(10,174,240,320);	//设置窗口	  
  OV7670_CS=0;				    		    
	ov_sta=2;//使能OV7670
	//cass_mv_main_init();
	
	while(1)//识别每一帧
	{		
			if(ComInDataOk)
			{
				UartRecvHandle(0);
				ComInDataOk = 0;
			}
		
			Camera_refresh();//OV7670刷新 
			
			//cass_mv_main_entry();
			
			/*图像预处理*/
			Ostu_Program(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Denosing_Program(space_topbound[i],space_leftbound[i],cass_mv_boarder_height,cass_mv_boarder_width);
			//Gaussian(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//MediaFilter(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Laplace(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Mean(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Sobel(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Prewitt(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
						
			//Binary(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Hisgram(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Thin(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//AntiColor(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Grayscale(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Dialate(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Erode(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//InClean(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Open(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Close(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			//Gravity(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			Match(cass_mv_boarder_topbound,cass_mv_boarder_leftbound,cass_mv_boarder_height,cass_mv_boarder_width);
			
			
			LCD_Scan_Dir(U2D_L2R);		//设定LCD刷新方向
			LCD_SetCursor(0x00,0x0000);	//设置光标位置 
			LCD_WriteRAM_Prepare();     //开始写入GRAM					
			for(j=0;j<240;j++)
				for(i=0;i<320;i++)
				{	
					LCD->LCD_RAM=(u16)((raw_data[j*320+i]>>3)<<11|((raw_data[j*320+i]>>2)<<5)|(raw_data[j*320+i]>>3)<<0);			
				}
	}
}























